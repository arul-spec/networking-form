<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Site Work Form</title>
<style>
    body {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        background-color: #f4f6f8;
        margin: 0;
        padding: 0;
    }
    .container {
        max-width: 1000px;
        margin: auto;
        background: #ffffff;
        padding: 25px 30px;
        border-radius: 12px;
        box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        margin-top: 20px;
        margin-bottom: 20px;
    }
    h2, h3 {
        color: #2c3e50;
    }
    .work-type-buttons {
        display: flex;
        gap: 20px;
        margin-bottom: 25px;
    }
    .work-type-buttons button {
        flex: 1;
        padding: 14px;
        font-size: 16px;
        cursor: pointer;
        border: none;
        border-radius: 8px;
        background-color: #007bff;
        color: white;
        transition: background 0.3s;
    }
    .work-type-buttons button.active {
        background-color: #0056b3;
    }
    .form-group {
        margin-bottom: 18px;
    }
    label {
        display: block;
        font-weight: 500;
        margin-bottom: 6px;
        color: #34495e;
    }
    input[type="text"], input[type="number"], input[type="date"] {
        width: 100%;
        padding: 9px;
        border-radius: 6px;
        border: 1px solid #ccc;
        font-size: 14px;
        box-sizing: border-box;
    }
    table {
        width: 100%;
        border-collapse: collapse;
        margin-bottom: 25px;
    }
    th, td {
        border: 1px solid #ddd;
        padding: 6px;
        text-align: center;
        font-size: 14px;
    }
    th {
        background-color: #f0f0f0;
    }
    input[type="number"] {
        width: 70px;
    }
    .submit-btn {
        padding: 14px 20px;
        font-size: 16px;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        background-color: #28a745;
        color: white;
        width: 100%;
        font-weight: 500;
    }
    @media (max-width: 768px) {
        table, th, td {
            font-size: 12px;
        }
        .work-type-buttons {
            flex-direction: column;
        }
        .work-type-buttons button {
            width: 100%;
        }
    }
</style>
</head>
<body>
<div class="container">
    <h2>Site Work Form</h2>

    <div class="work-type-buttons">
        <button id="actualBtn" class="active" onclick="selectWorkType('Actual')">Actual</button>
        <button id="billableBtn" onclick="selectWorkType('Billable')">Billable</button>
    </div>

    <div class="form-group">
        <label for="clientName">Site / Client Name</label>
        <input type="text" id="clientName" placeholder="Enter site or client name" required>

        <label for="siteEngineer">Site Engineer Name</label>
        <input type="text" id="siteEngineer" placeholder="Enter site engineer name" required>
    </div>

    <h3>Ticket Information</h3>
    <div class="form-group">
        <label for="dtID">DT Ticket ID</label>
        <input type="text" id="dtID" placeholder="Enter DT Ticket ID" required>

        <label for="srmID">SRM Ticket ID</label>
        <input type="text" id="srmID" placeholder="Enter SRM Ticket ID" required>

        <label for="workDate">Date</label>
        <input type="date" id="workDate" required>

        <label for="location">Location</label>
        <input type="text" id="location" placeholder="Enter location" required>
    </div>

    <table>
        <thead>
            <tr>
                <th>Work Item</th>
                <th>Install</th>
                <th>Remove</th>
                <th>Repair</th>
                <th>Meters / Nos / Size</th>
            </tr>
        </thead>
        <tbody id="workTableBody">
            <script>
                const workFields = [
                    'Rack', 'Cat6', 'PVC', 'FPBB', 'IO', 'Patch Panel', 'Switch',
                    'Patch Cord 1m', 'Patch Cord 2m', 'AP', 'HDPE', 'OFC', 'LIU', 'Splice',
                    'Trenching Works', 'Wall Cutting', 'Core Cutting'
                ];
                for (let field of workFields) {
                    document.write(`<tr>
                        <td>${field}</td>
                        <td><input type="number" min="0" value="0" id="${field.replace(/ /g,'_').toLowerCase()}_install"></td>
                        <td><input type="number" min="0" value="0" id="${field.replace(/ /g,'_').toLowerCase()}_remove"></td>
                        <td><input type="number" min="0" value="0" id="${field.replace(/ /g,'_').toLowerCase()}_repair"></td>
                        <td><input type="number" min="0" value="0" id="${field.replace(/ /g,'_').toLowerCase()}_size"></td>
                    </tr>`);
                }
            </script>
        </tbody>
    </table>

    <button class="submit-btn" id="submitBtn" onclick="submitForm()">Submit Actual Work</button>
</div>

<script>
    let selectedWorkType = 'Actual';

    function selectWorkType(type) {
        selectedWorkType = type;
        document.getElementById('submitBtn').textContent = `Submit ${type} Work`;
        document.getElementById('actualBtn').classList.remove('active');
        document.getElementById('billableBtn').classList.remove('active');
        if (type === 'Actual') {
            document.getElementById('actualBtn').classList.add('active');
        } else {
            document.getElementById('billableBtn').classList.add('active');
        }
    }

    function submitForm() {
        const data = {
            workType: selectedWorkType,
            dtID: document.getElementById('dtID').value,
            srmID: document.getElementById('srmID').value,
            date: document.getElementById('workDate').value,
            location: document.getElementById('location').value,
            siteEngineer: document.getElementById('siteEngineer').value,
            clientName: document.getElementById('clientName').value
        };
        const workFields = [
            'rack', 'cat6', 'pvc', 'fpbb', 'io', 'patch_panel', 'switch',
            'patch_cord_1m', 'patch_cord_2m', 'ap', 'hdpe', 'ofc', 'liu', 'splice',
            'trenching_works', 'wall_cutting', 'core_cutting'
        ];
        for (let field of workFields) {
            data[`${field}_install`] = document.getElementById(`${field}_install`).value;
            data[`${field}_remove`] = document.getElementById(`${field}_remove`).value;
            data[`${field}_repair`] = document.getElementById(`${field}_repair`).value;
            data[`${field}_size`] = document.getElementById(`${field}_size`).value;
        }

        google.script.run.withSuccessHandler(() => {
            alert(`${selectedWorkType} work submitted successfully!`);
            location.reload();
        }).submitWorkData(data);
    }
</script>
</body>
</html>
